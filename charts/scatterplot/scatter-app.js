Number.prototype.format = function () {
    return this.toString().split( /(?=(?:\d{3})+(?:\.|$))/g ).join( "," );
};

$(function () {
$('#container').highcharts({
      chart: {
          type: 'scatter',
          zoomType: 'xy'
      },
      title: {
          text: 'Normierte Personenzahl vs Distanz zu Düsseldorf'
      },
      xAxis: {
          title: { text: "Entfernung von Düsseldorf" },
          min: 0,
          labels: {format:"{value} km"},
          startOnTick: true,
          endOnTick: true,
          showLastLabel: true
      },
      yAxis: {
          title: {text: 'Anteil Düsseldorfer an der Bevölkerung'},
          min: 0,
          max: 0.022,
          endOnTick: false,
      },
      legend: {
          layout: 'vertical',
          align: 'right',
          verticalAlign: 'top',
          x: -100,
          y: 70,
          floating: true,
          backgroundColor: '#FFFFFF',
          borderWidth: 1
      },
      plotOptions: {
          scatter: {
              marker: {
                  radius: 5,
                  states: {
                      hover: {
                          enabled: true,
                          lineColor: 'rgb(100,100,100)'
                      }
                  }
              },
          }
      },

      tooltip: {
            useHTML: true,
            formatter: function() { return ' ' +
            '<p>Orte in diesem Gebiet: <br>' +
            '<b>' + this.point.orte + '</b></p>' +
            '<em>' + Math.round(this.point.x).toLocaleString("de-DE") + '</em> km entfernt<br>' +
            '<em>' + this.point.countsum.toLocaleString("de-DE") + '</em> Düsseldorfer von ca. ' +
            '<em>' + (Math.round(this.point.pops/1000)*1000).toLocaleString("de-DE") + '</em> Einwohnern'
            },
            hideDelay: 100,
     },

      series: [
        {
          name: 'Herkunftsgebiete',
          color: "rgba(255,193,0,0.4)",
          data: scatterpoints
        },
        {
          name: 'Ausreißer',
          color: "rgba(255,129,100,0.4)",
          data: ausreisser,
          marker: {
            symbol: 'circle'
          }
        },
       {
          type: 'spline',
          name: 'Trendlinie',
          color: "#42cac6",
          data: [
  [15.0269436743333,0.0105334736112918  ],
  [247.912322374857,0.00881412508268931  ],
  [480.797701075381,0.00737542085737142  ],
  [713.683079775905,0.0061715521748362  ],
  [946.568458476429,0.00516418750648757  ],
  [1179.45383717695,0.00432125206862894  ],
  [1412.33921587748,0.00361590655203193  ],
  [1645.224594578,0.00302569255053337  ],
  [1878.10997327852,0.00253181747885841  ],
  [2110.99535197905,0.00211855621124592  ],
  [2343.88073067957,0.00177275038887574  ],
  [2576.7661093801,0.00148338945390121  ],
  [2809.65148808062,0.00124126007008851  ],
  [3042.53686678114,0.00103865276751437  ],
  [3275.42224548167,0.000869116470804013  ],
  [3508.30762418219,0.000727253095017022  ],
  [3741.19300288271,0.000608545669054642  ],
  [3974.07838158324,0.000509214513987725  ],
  [4206.96376028376,0.000426096896981568  ],
  [4439.84913898429,0.000356546328963627  ],
  [4672.73451768481,0.0002983482996426  ],
  [4905.61989638533,0.000249649766857399  ],
  [5138.50527508586,0.000208900155176398  ],
  [5371.39065378638,0.000174801985125225  ],
  [5604.27603248691,0.000146269561063359  ],
  [5837.16141118743,0.000122394402319522  ],
  [6070.04678988795,0.000102416316903173  ],
  [6302.93216858848,0.0000856991967706853  ],
  [6535.817547289,0.0000717107639604359  ],
  [6768.70292598953,0.0000600056227078711  ],
  [7001.58830469005,0.0000502110779149687  ],
  [7234.47368339057,0.0000420152684300425  ],
  [7467.3590620911,0.0000351572372980718  ],
  [7700.24444079162,0.0000294186228154411  ],
  [7933.12981949214,0.0000246167058298593  ],
  [8166.01519819267,0.0000205985919094678  ],
  [8398.90057689319,0.0000172363431397115  ],
  [8631.78595559371,0.0000144229045429716  ],
  [8864.67133429424,0.0000120686954169765  ],
  [9097.55671299476,0.0000100987570592171  ],
  [9330.44209169529,0.00000845036606008218  ],
  [9563.32747039581,0.00000707103717127389  ],
  [9796.21284909633,0.00000591685216025433  ],
  [10029.0982277969,0.00000495106144096244  ],
  [10261.9836064974,0.00000414291395631752  ],
  [10494.8689851979,0.000003466678055628  ],
  [10727.7543638984,0.00000290082219135803  ],
  [10960.639742599,0.00000242732934839859  ],
  [11193.5251212995,0.00000203112337707221  ],
  [11426.4105,0.00000169958896414735  ]
],
          marker: {
            enabled: false
          },
          states: {
            hover: {
                  lineWidth: 0
            }
          },
          enableMouseTracking: false
       }
   ]
   });
});
